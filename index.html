<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>우리반 교실 허브</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Yeon+Sung&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="background-mesh"></div>

    <div class="app-container">
        <!-- Floating Home Button (Visible only when not on home) -->
        <button id="global-home-btn" class="floating-home hidden">
            🏠 홈으로
        </button>

        <!-- Main Home Dashboard -->
        <section id="home" class="active-section dashboard-layout">
            <div class="home-title">
                <h1>순천성동초등학교<br>6학년 1반의 스마트 교실</h1>
            </div>

            <div class="nav-grid">
                <!-- Row 1 -->
                <button class="nav-card" data-target="links">
                    <span class="icon">🔗</span>
                    <span class="label">바로가기</span>
                </button>
                <button class="nav-card" data-target="games">
                    <span class="icon">🎮</span>
                    <span class="label">쉬는시간</span>
                </button>
                <button class="nav-card" data-target="timetable">
                    <span class="icon">📅</span>
                    <span class="label">시간표</span>
                </button>
                <!-- Row 2 -->
                <button class="nav-card" data-target="timer">
                    <span class="icon">⏳</span>
                    <span class="label">타이머</span>
                </button>
                <button class="nav-card" data-target="random">
                    <span class="icon">🎰</span>
                    <span class="label">랜덤추첨</span>
                </button>
                <button class="nav-card" data-target="seating">
                    <span class="icon">🎲</span>
                    <span class="label">자리배치</span>
                </button>
                <!-- Row 3 -->
                <button class="nav-card" data-target="guestbook">
                    <span class="icon">📝</span>
                    <span class="label">방명록</span>
                </button>
            </div>

            <div class="bottom-widgets">
                <div class="widget">
                    <h3>오늘의 날씨</h3>
                    <div class="weather-placeholder">맑음 ☀️ 24°C</div>
                </div>
                <div class="widget center-widget" style="display:flex; align-items:center; justify-content:center;">
                    <div class="date-display" id="current-date"></div>
                </div>
                <div class="widget">
                    <h3>오늘의 명언</h3>
                    <p id="daily-quote">"배움에는 끝이 없다."</p>
                </div>
                <div class="widget">
                    <h3>방문자 수</h3>
                    <div id="visitor-count" style="font-size: 1.5rem; font-weight: bold;">0</div>
                </div>
            </div>
        </section>

        <!-- Feature Sections -->
        <main class="content-frame">
            <section id="links" class="hidden-section">
                <h2>바로가기 링크</h2>
                <div class="links-grid" id="links-container">
                    <!-- Links inserted by JS -->
                </div>
            </section>

            <section id="guestbook" class="hidden-section">
                <h2>📝 우리반 방명록</h2>
                <div class="guestbook-input-area">
                    <div class="guest-info-row">
                        <input type="text" id="guest-name" placeholder="이름 (생략가능)" maxlength="10">
                        <input type="password" id="guest-pw" placeholder="비밀번호 (삭제용)" maxlength="4">
                    </div>
                    <textarea id="guest-msg" placeholder="여기에 친구들에게 하고 싶은 말을 남겨보세요! (최대 50자)" maxlength="50"></textarea>
                    <div class="input-actions">
                        <div id="color-picker" class="color-picker">
                            <button class="color-btn selected" data-color="#fffcd0"
                                style="background:#fffcd0;"></button> <!-- Classic Yellow -->
                            <button class="color-btn" data-color="#ffccdd" style="background:#ffccdd;"></button>
                            <!-- Pink -->
                            <button class="color-btn" data-color="#ccffcc" style="background:#ccffcc;"></button>
                            <!-- Green -->
                            <button class="color-btn" data-color="#ccf2ff" style="background:#ccf2ff;"></button>
                            <!-- Blue -->
                        </div>
                        <button id="post-note-btn" class="primary-btn">붙이기</button>
                    </div>
                </div>
                <div id="guestbook-wall" class="guestbook-wall">
                    <!-- Notes go here -->
                </div>
            </section>

            <section id="games" class="hidden-section">
                <h2>쉬는시간 게임</h2>
                <div class="games-menu" id="games-menu">
                    <!-- Game selection -->
                </div>
                <div class="game-stage hidden" id="game-stage">
                    <button id="back-to-games" class="secondary-btn">← 게임 목록</button>
                    <div id="game-container"></div>
                </div>
            </section>

            <section id="timer" class="hidden-section">
                <h2>타이머 & 스톱워치</h2>
                <div class="timer-container">
                    <div class="timer-controls">
                        <input type="number" id="timer-minutes" placeholder="분" min="0">
                        <input type="number" id="timer-seconds" placeholder="초" min="0" max="59">
                        <button id="start-timer" class="primary-btn">시작</button>
                        <button id="reset-timer" class="secondary-btn">리셋</button>
                    </div>
                    <div class="timer-display" id="timer-display">00:00</div>
                </div>
            </section>

            <section id="seating" class="hidden-section">
                <h2>번호 뽑기 자리 배치</h2>
                <div class="seating-controls-container">
                    <!-- Main Settings -->
                    <div class="seating-main-settings">
                        <div class="input-group">
                            <label>전체 학생 수</label>
                            <input type="number" id="total-students" placeholder="25" min="1" max="50">
                        </div>
                        <button id="generate-seats" class="primary-btn">배치 시작!</button>
                    </div>

                    <!-- Fixed Exception Rules -->
                    <div class="seating-exceptions">
                        <h3>🔒 고정석 설정</h3>
                        <div class="exception-input-row">
                            <input type="number" id="fix-student" placeholder="학생 번호" min="1">
                            <span>번 학생을</span>
                            <input type="number" id="fix-seat" placeholder="자리 번호" min="1">
                            <span>번 자리에</span>
                            <button id="add-fix-rule" class="secondary-btn small-btn">추가</button>
                        </div>
                        <div id="fixed-rules-list" class="fixed-rules-list">
                            <!-- Rules added here -->
                        </div>
                    </div>
                </div>

                <div class="seating-grid" id="seating-grid"></div>
            </section>

            <section id="random" class="hidden-section">
                <h2>🎰 행운의 번호 추첨</h2>
                <div class="draw-container">
                    <div class="draw-controls">
                        <label>범위:</label>
                        <input type="number" id="draw-min" value="1" min="1">
                        <span>~</span>
                        <input type="number" id="draw-max" value="25" min="1">
                        <button id="start-draw-btn" class="primary-btn">추첨 시작!</button>
                    </div>
                    <div class="draw-display-box">
                        <div id="draw-display">?</div>
                        <div id="draw-result">두구두구...</div>
                    </div>
                </div>
            </section>

            <section id="timetable" class="hidden-section">
                <h2>우리반 시간표</h2>
                <div class="timetable-editor">
                    <div id="subject-palette" class="subject-palette">
                        <!-- Draggable subjects generated by JS -->
                    </div>
                    <!-- Grid -->
                    <table class="timetable-table">
                        <thead>
                            <tr>
                                <th>교시</th>
                                <th>월</th>
                                <th>화</th>
                                <th>수</th>
                                <th>목</th>
                                <th>금</th>
                            </tr>
                        </thead>
                        <tbody id="timetable-body">
                            <!-- Rows generated by JS -->
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <script type="module" src="script.js"></script>
    <script>
        // Safety check for module loading issues (e.g. file:// protocol blocking)
        window.addEventListener('load', () => {
            setTimeout(() => {
                if (!window.appInitialized) {
                    console.warn("App script did not initialize. Check if running via local server.");
                    // Optional: Visual cue for the user?
                    // alert("스크립트가 로딩되지 않았습니다. 파일로 직접 열지 말고 라이브 서버를 사용해주세요.");
                }
            }, 500);
        });
    </script>
</body>

</html>